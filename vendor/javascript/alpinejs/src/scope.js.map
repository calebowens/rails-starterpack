// alpinejs@3.13.5/src/scope.js.map downloaded from https://ga.jspm.io/npm:alpinejs@3.13.5/src/scope.js.map

{"version":3,"file":"scope.js","sources":["../src/scope.js"],"sourcesContent":["\nexport function scope(node) {\n    return mergeProxies(closestDataStack(node))\n}\n\nexport function addScopeToNode(node, data, referenceNode) {\n    node._x_dataStack = [data, ...closestDataStack(referenceNode || node)]\n\n    return () => {\n        node._x_dataStack = node._x_dataStack.filter(i => i !== data)\n    }\n}\n\nexport function hasScope(node) {\n    return !! node._x_dataStack\n}\n\nexport function closestDataStack(node) {\n    if (node._x_dataStack) return node._x_dataStack\n\n    if (typeof ShadowRoot === 'function' && node instanceof ShadowRoot) {\n        return closestDataStack(node.host)\n    }\n\n    if (! node.parentNode) {\n        return []\n    }\n\n    return closestDataStack(node.parentNode)\n}\n\nexport function closestDataProxy(el) {\n    return mergeProxies(closestDataStack(el))\n}\n\nexport function mergeProxies (objects) {\n    return new Proxy({ objects }, mergeProxyTrap);\n}\n\nlet mergeProxyTrap = {\n    ownKeys({ objects }) {\n        return Array.from(\n            new Set(objects.flatMap((i) => Object.keys(i)))\n        )\n    },\n\n    has({ objects }, name) {\n        if (name == Symbol.unscopables) return false;\n\n        return objects.some((obj) =>\n            Object.prototype.hasOwnProperty.call(obj, name)\n        );\n    },\n\n    get({ objects }, name, thisProxy) {\n        if (name == \"toJSON\") return collapseProxies\n\n        return Reflect.get(\n            objects.find((obj) =>\n                Object.prototype.hasOwnProperty.call(obj, name)\n            ) || {},\n            name,\n            thisProxy\n        )\n    },\n\n    set({ objects }, name, value, thisProxy) {\n        const target = objects.find((obj) =>\n                Object.prototype.hasOwnProperty.call(obj, name)\n            ) || objects[objects.length - 1];\n        const descriptor = Object.getOwnPropertyDescriptor(target, name);\n        if (descriptor?.set && descriptor?.get)\n            return Reflect.set(target, name, value, thisProxy);\n        return Reflect.set(target, name, value);\n    },\n}\n\nfunction collapseProxies() {\n    let keys = Reflect.ownKeys(this)\n\n    return keys.reduce((acc, key) => {\n        acc[key] = Reflect.get(this, key)\n\n        return acc;\n    }, {})\n}\n"],"names":["scope","node","mergeProxies","closestDataStack","addScopeToNode","data","referenceNode","_x_dataStack","filter","i","hasScope","ShadowRoot","host","parentNode","closestDataProxy","el","objects","Proxy","mergeProxyTrap","ownKeys","Array","from","Set","flatMap","Object","keys","has","name","Symbol","unscopables","some","obj","prototype","hasOwnProperty","call","get","thisProxy","collapseProxies","Reflect","find","set","value","target","length","descriptor","getOwnPropertyDescriptor","this","reduce","acc","key"],"mappings":"AACO,SAASA,MAAMC,GAClB,OAAOC,aAAaC,iBAAiBF,GACzC,CAEO,SAASG,eAAeH,EAAMI,EAAMC,GACvCL,EAAKM,aAAe,CAACF,KAASF,iBAAiBG,GAAiBL,IAEhE,MAAO,KACHA,EAAKM,aAAeN,EAAKM,aAAaC,QAAOC,GAAKA,IAAMJ,GAAK,CAErE,CAEO,SAASK,SAAST,GACrB,QAAUA,EAAKM,YACnB,CAEO,SAASJ,iBAAiBF,GAC7B,OAAIA,EAAKM,aAAqBN,EAAKM,oBAExBI,aAAe,YAAcV,aAAgBU,WAC7CR,iBAAiBF,EAAKW,MAG3BX,EAAKY,WAIJV,iBAAiBF,EAAKY,YAHlB,EAIf,CAEO,SAASC,iBAAiBC,GAC7B,OAAOb,aAAaC,iBAAiBY,GACzC,CAEO,SAASb,aAAcc,GAC1B,OAAO,IAAIC,MAAM,CAAED,WAAWE,EAClC,CAEA,IAAIA,EAAiB,CACjB,OAAAC,EAAQH,QAAEA,IACN,OAAOI,MAAMC,KACT,IAAIC,IAAIN,EAAQO,SAASd,GAAMe,OAAOC,KAAKhB,MAElD,EAED,GAAAiB,EAAIV,QAAEA,GAAWW,GACb,OAAIA,GAAQC,OAAOC,aAEZb,EAAQc,MAAMC,GACjBP,OAAOQ,UAAUC,eAAeC,KAAKH,EAAKJ,IAEjD,EAED,GAAAQ,EAAInB,QAAEA,GAAWW,EAAMS,GACnB,OAAIT,GAAQ,SAAiBU,gBAEtBC,QAAQH,IACXnB,EAAQuB,MAAMR,GACVP,OAAOQ,UAAUC,eAAeC,KAAKH,EAAKJ,MACzC,CAAE,EACPA,EACAS,EAEP,EAED,GAAAI,EAAIxB,QAAEA,GAAWW,EAAMc,EAAOL,GAC1B,MAAMM,EAAS1B,EAAQuB,MAAMR,GACrBP,OAAOQ,UAAUC,eAAeC,KAAKH,EAAKJ,MACzCX,EAAQA,EAAQ2B,OAAS,GAClC,MAAMC,EAAapB,OAAOqB,yBAAyBH,EAAQf,GAC3D,OAAIiB,GAAYJ,KAAOI,GAAYT,IACxBG,QAAQE,IAAIE,EAAQf,EAAMc,EAAOL,GACrCE,QAAQE,IAAIE,EAAQf,EAAMc,EACpC,GAGL,SAASJ,kBACL,IAAIZ,EAAOa,QAAQnB,QAAQ2B,MAE3B,OAAOrB,EAAKsB,QAAO,CAACC,EAAKC,KACrBD,EAAIC,GAAOX,QAAQH,IAAIW,KAAMG,GAE7B,OAAOD,CAAG,GACX,GACP"}