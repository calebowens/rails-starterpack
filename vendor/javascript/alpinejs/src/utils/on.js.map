// alpinejs@3.13.5/src/utils/on.js.map downloaded from https://ga.jspm.io/npm:alpinejs@3.13.5/src/utils/on.js.map

{"version":3,"file":"on.js","sources":["../../src/utils/on.js"],"sourcesContent":["import { debounce } from './debounce'\nimport { throttle } from './throttle'\n\nexport default function on (el, event, modifiers, callback) {\n    let listenerTarget = el\n\n    let handler = e => callback(e)\n\n    let options = {}\n\n    // This little helper allows us to add functionality to the listener's\n    // handler more flexibly in a \"middleware\" style.\n    let wrapHandler = (callback, wrapper) => (e) => wrapper(callback, e)\n\n    if (modifiers.includes(\"dot\")) event = dotSyntax(event)\n    if (modifiers.includes('camel')) event = camelCase(event)\n    if (modifiers.includes('passive')) options.passive = true\n    if (modifiers.includes('capture')) options.capture = true\n    if (modifiers.includes('window')) listenerTarget = window\n    if (modifiers.includes('document')) listenerTarget = document\n\n    // By wrapping the handler with debounce & throttle first, we ensure that the wrapping logic itself is not\n    // throttled/debounced, only the user's callback is. This way, if the user expects\n    // `e.preventDefault()` to happen, it'll still happen even if their callback gets throttled.\n    if (modifiers.includes('debounce')) {\n        let nextModifier = modifiers[modifiers.indexOf('debounce')+1] || 'invalid-wait'\n        let wait = isNumeric(nextModifier.split('ms')[0]) ? Number(nextModifier.split('ms')[0]) : 250\n\n        handler = debounce(handler, wait)\n    }\n    if (modifiers.includes('throttle')) {\n        let nextModifier = modifiers[modifiers.indexOf('throttle')+1] || 'invalid-wait'\n        let wait = isNumeric(nextModifier.split('ms')[0]) ? Number(nextModifier.split('ms')[0]) : 250\n\n        handler = throttle(handler, wait)\n    }\n\n    if (modifiers.includes('prevent')) handler = wrapHandler(handler, (next, e) => { e.preventDefault(); next(e) })\n    if (modifiers.includes('stop')) handler = wrapHandler(handler, (next, e) => { e.stopPropagation(); next(e) })\n    if (modifiers.includes('self')) handler = wrapHandler(handler, (next, e) => { e.target === el && next(e) })\n\n    if (modifiers.includes('away') || modifiers.includes('outside')) {\n        listenerTarget = document\n\n        handler = wrapHandler(handler, (next, e) => {\n            if (el.contains(e.target)) return\n\n            if (e.target.isConnected === false) return\n\n            if (el.offsetWidth < 1 && el.offsetHeight < 1) return\n\n            // Additional check for special implementations like x-collapse\n            // where the element doesn't have display: none\n            if (el._x_isShown === false) return\n\n            next(e)\n        })\n    }\n\n    if (modifiers.includes('once')) {\n        handler = wrapHandler(handler, (next, e) => {\n            next(e)\n\n            listenerTarget.removeEventListener(event, handler, options)\n        })\n    }\n\n    // Handle :keydown and :keyup listeners.\n    handler = wrapHandler(handler, (next, e) => {\n        if (isKeyEvent(event)) {\n            if (isListeningForASpecificKeyThatHasntBeenPressed(e, modifiers)) {\n                return\n            }\n        }\n\n        next(e)\n    })\n\n    listenerTarget.addEventListener(event, handler, options)\n\n    return () => {\n        listenerTarget.removeEventListener(event, handler, options)\n    }\n}\n\nfunction dotSyntax(subject) {\n    return subject.replace(/-/g, \".\")\n}\n\nfunction camelCase(subject) {\n    return subject.toLowerCase().replace(/-(\\w)/g, (match, char) => char.toUpperCase())\n}\n\nfunction isNumeric(subject){\n    return ! Array.isArray(subject) && ! isNaN(subject)\n}\n\nfunction kebabCase(subject) {\n    if ([' ','_'].includes(subject\n    )) return subject\n    return subject.replace(/([a-z])([A-Z])/g, '$1-$2').replace(/[_\\s]/, '-').toLowerCase()\n}\n\nfunction isKeyEvent(event) {\n    return ['keydown', 'keyup'].includes(event)\n}\n\nfunction isListeningForASpecificKeyThatHasntBeenPressed(e, modifiers) {\n    let keyModifiers = modifiers.filter(i => {\n        return ! ['window', 'document', 'prevent', 'stop', 'once', 'capture'].includes(i)\n    })\n\n    if (keyModifiers.includes('debounce')) {\n        let debounceIndex = keyModifiers.indexOf('debounce')\n        keyModifiers.splice(debounceIndex, isNumeric((keyModifiers[debounceIndex+1] || 'invalid-wait').split('ms')[0]) ? 2 : 1)\n    }\n\n    if (keyModifiers.includes('throttle')) {\n        let debounceIndex = keyModifiers.indexOf('throttle')\n        keyModifiers.splice(debounceIndex, isNumeric((keyModifiers[debounceIndex+1] || 'invalid-wait').split('ms')[0]) ? 2 : 1)\n    }\n\n    // If no modifier is specified, we'll call it a press.\n    if (keyModifiers.length === 0) return false\n\n    // If one is passed, AND it matches the key pressed, we'll call it a press.\n    if (keyModifiers.length === 1 && keyToModifiers(e.key).includes(keyModifiers[0])) return false\n\n    // The user is listening for key combinations.\n    const systemKeyModifiers = ['ctrl', 'shift', 'alt', 'meta', 'cmd', 'super']\n    const selectedSystemKeyModifiers = systemKeyModifiers.filter(modifier => keyModifiers.includes(modifier))\n\n    keyModifiers = keyModifiers.filter(i => ! selectedSystemKeyModifiers.includes(i))\n\n    if (selectedSystemKeyModifiers.length > 0) {\n        const activelyPressedKeyModifiers = selectedSystemKeyModifiers.filter(modifier => {\n            // Alias \"cmd\" and \"super\" to \"meta\"\n            if (modifier === 'cmd' || modifier === 'super') modifier = 'meta'\n\n            return e[`${modifier}Key`]\n        })\n\n        // If all the modifiers selected are pressed, ...\n        if (activelyPressedKeyModifiers.length === selectedSystemKeyModifiers.length) {\n            // AND the remaining key is pressed as well. It's a press.\n            if (keyToModifiers(e.key).includes(keyModifiers[0])) return false\n        }\n    }\n\n    // We'll call it NOT a valid keypress.\n    return true\n}\n\nfunction keyToModifiers(key) {\n    if (! key) return []\n\n    key = kebabCase(key)\n\n    let modifierToKeyMap = {\n        'ctrl': 'control',\n        'slash': '/',\n        'space': ' ',\n        'spacebar': ' ',\n        'cmd': 'meta',\n        'esc': 'escape',\n        'up': 'arrow-up',\n        'down': 'arrow-down',\n        'left': 'arrow-left',\n        'right': 'arrow-right',\n        'period': '.',\n        'equal': '=',\n        'minus': '-',\n        'underscore': '_',\n    }\n\n    modifierToKeyMap[key] = key\n\n    return Object.keys(modifierToKeyMap).map(modifier => {\n        if (modifierToKeyMap[modifier] === key) return modifier\n    }).filter(modifier => modifier)\n}\n"],"names":["on","el","event","modifiers","callback","listenerTarget","handler","e","options","wrapHandler","wrapper","includes","dotSyntax","camelCase","passive","capture","window","document","nextModifier","indexOf","wait","isNumeric","split","Number","debounce","throttle","next","preventDefault","stopPropagation","target","contains","isConnected","offsetWidth","offsetHeight","_x_isShown","removeEventListener","isKeyEvent","isListeningForASpecificKeyThatHasntBeenPressed","addEventListener","subject","replace","toLowerCase","match","char","toUpperCase","Array","isArray","isNaN","kebabCase","keyModifiers","filter","i","debounceIndex","splice","length","keyToModifiers","key","systemKeyModifiers","selectedSystemKeyModifiers","modifier","activelyPressedKeyModifiers","modifierToKeyMap","ctrl","slash","space","spacebar","cmd","esc","up","down","left","right","period","equal","minus","underscore","Object","keys","map"],"mappings":"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"}